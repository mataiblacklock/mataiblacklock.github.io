<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Astrodynamics in Python - Interplanetary Environment</title>
  <meta name="description" content="Industrial Engineer | Sustainability Advocate | Aspiring Consultant">
  <meta name="author" content="Matai Blacklock">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Matai Blacklock">
  <meta name="twitter:description" content="Industrial Engineer | Sustainability Advocate | Aspiring Consultant">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Matai Blacklock">
  <meta property="og:description" content="Industrial Engineer | Sustainability Advocate | Aspiring Consultant">

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <meta name="google-site-verification" content="z20XeFMapM0-GFHx3HRdlW-M6kDhsxoKQbCzb9_Z-ec" />

  <link rel="stylesheet" href="/css/app.css">
  <link rel="canonical" href="localhost:4000/2016/astrodynamics-in-python-interplanetary-environment/">
  <link rel="alternate" type="application/rss+xml" title="Matai Blacklock" href="/feed.xml">

   
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-83003527-1', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>

<header class="panel-cover" style="background-image: url(/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/" title="link to home of Matai Blacklock">
          <img src="/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Matai Blacklock</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Industrial Engineer | Sustainability Advocate | Aspiring Consultant</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="link to Matai Blacklock blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/MataiBlacklock" title="MataiBlacklock on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            

            

            

            
              <!-- LinkedIn -->
              <li class="navigation__item">
                <a href="https://www.linkedin.com/in/matai-blacklock" title="matai-blacklock on LinkedIn" target="_blank">
                  <i class="icon icon-social-linkedin"></i>
                  <span class="label">LinkedIn</span>
                </a>
              </li>
            

            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="https://www.instagram.com/its.my.tie" title="its.my.tie on Instagram" target="_blank">
                  <i class="icon icon-social-instagram"></i>
                  <span class="label">Instagram</span>
                </a>
              </li>
            

            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:matai.blacklock@gmail.com" title="Email matai.blacklock@gmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>

            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
  <time datetime="26 Jul 2016" class="post-meta__date date">
    26 Jul 2016
  </time>
  &#8226;
  <span class="post-meta__tags">
    
      <a href="/tags/#Astrodynamics">Astrodynamics</a>
    
      <a href="/tags/#Python">Python</a>
    
      <a href="/tags/#NumPy">NumPy</a>
    
      <a href="/tags/#Planets">Planets</a>
    
      <a href="/tags/#Physics">Physics</a>
    
  </span>
</div>

    <h1 class="post-title">Astrodynamics in Python - Interplanetary Environment</h1>
  </header>

  <section class="post">
    <p>How will humans get to Mars? To answer this question, extensive virtual simulations need to be conducted in order to properly plan such a mission. This is not a simple task by any regard. From the perspective of dynamics, essentially, one must ask: starting from a parking orbit about Earth, how must I throttle the spacecraft’s propulsion system at each moment in time to arrive in a parking orbit around Mars?</p>

<p>To make this question even more involved, constraints may be placed throughout the various stages of the spacecraft’s journey. For instance: the spacecraft may only be able to launch during a certain time period, the duration of the journey can only be up to a certain value, the spacecraft’s ability to withstand solar radiation is limited, or maybe there is a desired sequence of planet’s to fly by.</p>

<p>The research field in which the dynamics of this question are subsumed is called <em>Astrodynamics</em>.</p>

<blockquote>
  <p>Astrodynamics is the application of ballistics and celestial mechanics to the practical problems concerning the motion of rockets and other spacecraft. The motion of these objects is usually calculated from Newton’s laws of motion and Newton’s law of universal gravitation. It is a core discipline within space mission design and control. Celestial mechanics treats more broadly the orbital dynamics of systems under the influence of gravity, including both spacecraft and natural astronomical bodies such as star systems, planets, moons, and comets. Orbital mechanics focuses on spacecraft trajectories, including orbital maneuvers, orbit plane changes, and interplanetary transfers, and is used by mission planners to predict the results of propulsive maneuvers. General relativity is a more exact theory than Newton’s laws for calculating orbits, and is sometimes necessary for greater accuracy or in high-gravity situations (such as orbits close to the Sun). - <a href="https://en.wikipedia.org/wiki/Orbital_mechanics">Wikipedia</a></p>
</blockquote>

<p>Simple pen and paper mathematical analysis no longer suffices for this field of research. In fact, it never really did; the dynamics of interplanetary spaceflight are highly non-linear. Even in the days of the <a href="https://www.linux.com/news/how-they-built-it-software-apollo-11">Apollo Missions</a>, complex computations were done with the help of punch cards. The world of technology has come a very long way since then (although Fortran is still the <a href="https://indico.esa.int/indico/event/111/session/32/contribution/126/material/paper/0.pdf">fastest</a>), and such computations have become as painless as ever. So painless, in fact, interplanetary missions can now be simulated in <a href="https://www.python.org/">Python</a></p>

<p><a href="https://en.wikipedia.org/wiki/Punched_card_input/output"><img src="https://upload.wikimedia.org/wikipedia/commons/c/c7/IBM_650_at_Texas_A%26M.jpg" /></a>
<em>The Apollo Era</em></p>

<h2 id="definition-of-a-physical-body-newtonian-mechanics">Definition of a Physical Body (Newtonian Mechanics)</h2>
<p>In discussing how to utilize Python to conduct astrodynamical analyses it is fitting to begin at a rudimentary level, firstly directing attention to fundamental ideas.</p>

<p>In classical mechanics a physical body is collection of matter having properties including mass, velocity, momentum and energy. The matter exists in a volume of three-dimensional space. Following this definition the power of object-orientated programming can be exploited. In order to do this a class named <code class="highlighter-rouge">Body</code> is instantiated with a name, mass (<code class="highlighter-rouge">mass=None</code> to accommodate a negligible mass spacecraft), position, and velocity. For the body to be situated within a temporal context, it is necessary to instantiate the attribute of time. Additionally, it is convenient to keep track of all the physical bodies which have been instantiated in the simulation via <code class="highlighter-rouge">_instances=[]</code> and <code class="highlighter-rouge">Body._instances.append(self)</code>. Using the mathematical Python library <a href="http://www.numpy.org/">Numpy</a>, the physical body’s attributes can be represented in double-precision floating-point format via <code class="highlighter-rouge">dtype=np.float64</code> and propagated expeditiously with <a href="https://gcc.gnu.org/fortran/">Fortran</a> subroutines.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Body</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="c"># Instance record</span>
    <span class="n">_instances</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c"># __base__ attribute will return the Body class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__base__</span>   <span class="o">=</span> <span class="n">Body</span>
        <span class="c"># Name of body</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span>       <span class="o">=</span> <span class="n">name</span>
        <span class="c"># Mass of body</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
        <span class="c"># Time record</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">times</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="c"># Position record</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positions</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="c"># Velocity record</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="c"># Append to _instances</span>
        <span class="n">Body</span><span class="o">.</span><span class="n">_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
</code></pre>
</div>

<p>Once the attributes innate to a physical body’s abstract definition have been defined, more specific classifications can be made using class inheritance, in which <code class="highlighter-rouge">Body.__init__(self, name, mass)</code> is invoked in the descendant class’s <code class="highlighter-rouge">__init__</code> function.</p>

<h2 id="celestial-bodies">Celestial Bodies</h2>
<p>As interplanetary spaceflight is mainly gravitationally influenced, it is paramount to firstly instantiate the massive bodies that characterize the interplanetary environment that is the solar system.</p>

<blockquote>
  <p>An astronomical object or celestial object is a naturally occurring physical entity, association, or structure that current science has demonstrated to exist in the observable universe. The term astronomical object is sometimes used interchangeably with astronomical body. Typically, an astronomical (celestial) body refers to a single, cohesive structure that is bound together by gravity (and sometimes by electromagnetism). Examples include the asteroids, moons, planets and the stars. Astronomical objects are gravitationally bound structures that are associated with a position in space, but may consist of multiple independent astronomical bodies or objects. These objects range from single planets to star clusters, nebulae or entire galaxies. A comet may be described as a body, in reference to the frozen nucleus of ice and dust, or as an object, when describing the nucleus with its diffuse coma and tail. - <a href="https://en.wikipedia.org/wiki/Astronomical_object">Wikipedia</a></p>
</blockquote>

<p>The states of the various massive bodies that make up the solar system are easily attainable through <a href="ftp://ssd.jpl.nasa.gov/pub/eph/planets/README.txt">ephemerides</a>, which are graciously provided by <a href="http://www.jpl.nasa.gov/">NASA’s Jet Propulsion Laboratory</a>. The main attributes of interest are the massive bodies’ positions and velocities, which are easily determined for various specifications of time within <a href="ftp://ssd.jpl.nasa.gov/pub/eph/planets/bsp/">SPICE binary kernel files</a> as part of the <a href="https://naif.jpl.nasa.gov/naif/toolkit.html">SPICE Toolkit</a>. The kernels can be natively utilized in Python with the use of an open source JPL SPICE wrapper for Python, <a href="https://pypi.python.org/pypi/jplephem">jplephem 2.5</a>. Following the documentation, the JPL SPICE indices of the bodies must be defined. Such as it is, all the information know about the solar system’s various massive bodies can be aggregated into a function that serves as a callable dictionary.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">Celestial_Body_Attributes</span><span class="p">():</span>
    <span class="s">'''Returns all the attributes of a specified
    celestial body. All units are SI.'''</span>
    <span class="n">cba</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Sun'</span><span class="p">:</span>     <span class="p">{</span><span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">1.989500e+24</span><span class="p">,</span>
                       <span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">1392e+6</span><span class="p">},</span>
           <span class="s">'Earth'</span><span class="p">:</span>   <span class="p">{</span><span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">12756000.0</span><span class="p">,</span>
                       <span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">399</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">5.969999e+24</span><span class="p">},</span>
           <span class="s">'Jupiter'</span><span class="p">:</span> <span class="p">{</span><span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">142984000.0</span><span class="p">,</span>
                       <span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">1.898e+27</span><span class="p">},</span>
           <span class="s">'Mars'</span><span class="p">:</span>    <span class="p">{</span><span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">6792000.0</span><span class="p">,</span>
                       <span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">6.42e+23</span><span class="p">},</span>
           <span class="s">'Mercury'</span><span class="p">:</span> <span class="p">{</span><span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">4879000.0</span><span class="p">,</span>
                       <span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">199</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">3.3e+23</span><span class="p">},</span>
           <span class="s">'Moon'</span><span class="p">:</span>    <span class="p">{</span><span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">3475000.0</span><span class="p">,</span>
                       <span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">301</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">7.3e+22</span><span class="p">},</span>
           <span class="s">'Neptune'</span><span class="p">:</span> <span class="p">{</span><span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">49528000.0</span><span class="p">,</span>
                       <span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">1.019999e+26</span><span class="p">},</span>
           <span class="s">'Pluto'</span><span class="p">:</span>   <span class="p">{</span><span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">2370000.0</span><span class="p">,</span>
                       <span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">1.46e+22</span><span class="p">},</span>
           <span class="s">'Saturn'</span><span class="p">:</span>  <span class="p">{</span><span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">120536000.0</span><span class="p">,</span>
                       <span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">5.68e+26</span><span class="p">},</span>
           <span class="s">'Uranus'</span><span class="p">:</span>  <span class="p">{</span><span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">51118000.0</span><span class="p">,</span>
                       <span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">8.68e+25</span><span class="p">},</span>
           <span class="s">'Venus'</span><span class="p">:</span>   <span class="p">{</span><span class="s">'diameter'</span><span class="p">:</span>       <span class="mf">12104000.0</span><span class="p">,</span>
                       <span class="s">'jplephem_index'</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">299</span><span class="p">),</span>
                       <span class="s">'mass'</span><span class="p">:</span>           <span class="mf">4.87e+24</span><span class="p">}}</span>
    <span class="k">return</span> <span class="n">cba</span>
</code></pre>
</div>

<p>Next, each celestial body’s attributes can be self-assigned.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">Assign_Celestial_Body_Attributes</span><span class="p">(</span><span class="n">celestial_body</span><span class="p">):</span>
    <span class="s">'''This function assigns the attributes to a known celestial body.
    These attributes include the various facts of the celestial body,
    and its orbiting satellites if specified to be included.'''</span>
    <span class="c"># The name of the celestial body</span>
    <span class="n">name</span>       <span class="o">=</span> <span class="n">celestial_body</span><span class="o">.</span><span class="n">name</span>
    <span class="c"># The attributes of the celestial body</span>
    <span class="n">attributes</span> <span class="o">=</span> <span class="n">Celestial_Body_Attributes</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span>
    <span class="c"># Assign the factual attributes to the celestial body</span>
    <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">celestial_body</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">attributes</span><span class="p">[</span><span class="n">attribute</span><span class="p">])</span>
    <span class="k">return</span> <span class="bp">None</span>
</code></pre>
</div>

<p>And of these attributes, the body’s <code class="highlighter-rouge">jplephem_index</code> can be used to compute its position and velocity at a given time and the fully assembled <code class="highlighter-rouge">Celestial_Body</code> class can finally be constructed with inheritance from the <code class="highlighter-rouge">Body</code> class. Also, simple computations can be performed, such as relative position and velocity <code class="highlighter-rouge">Position_and_Velocity_WRT</code> and updating the celestial body’s state record in accordance the spacecraft’s time-step <code class="highlighter-rouge">Update_Position_and_Velocity</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Celestial_Body</span><span class="p">(</span><span class="n">Body</span><span class="p">):</span>
    <span class="c"># Instance record</span>
    <span class="n">_instances</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">satellites</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="c"># Fundamentally initialise the celestial body</span>
        <span class="n">Body</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">mass</span><span class="p">)</span>
        <span class="c"># Assign its unique attributes</span>
        <span class="n">Assign_Celestial_Body_Attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c"># If it is specified to include satellites</span>
        <span class="n">Celestial_Body</span><span class="o">.</span><span class="n">_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">def</span> <span class="nf">Position_and_Velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="c"># The JPL ephemeris index of the celestial body</span>
        <span class="n">jpli</span>       <span class="o">=</span> <span class="n">celestial_body</span><span class="o">.</span><span class="n">jplephem_index</span>
        <span class="c"># Path to ephemeris file</span>
        <span class="n">path_ephem</span> <span class="o">=</span> <span class="n">Directory</span> <span class="o">+</span> <span class="s">'/Information/Celestial_Bodies/Ephemerides/de430.bsp'</span>
        <span class="c"># The ephemeris kernel</span>
        <span class="n">kernel</span>     <span class="o">=</span> <span class="n">SPK</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="n">path_ephem</span><span class="p">)</span>
        <span class="c"># The position and velocity</span>
        <span class="n">pv</span>         <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">kernel</span><span class="p">[</span><span class="n">jpli</span><span class="p">]</span><span class="o">.</span><span class="n">compute_and_differentiate</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
        <span class="c"># If the ephemeris was wrt to its local barcyentre</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">jpli</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c"># Compute barycentric position rather</span>
            <span class="n">pv</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pv</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
                <span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">jpli</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">compute_and_differentiate</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span>
        <span class="c"># Convert km to m</span>
        <span class="n">pv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">pv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="mf">1e3</span><span class="p">)</span>
        <span class="c"># Convert km/day to m/s</span>
        <span class="n">pv</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">pv</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="mf">0.0115741</span><span class="p">)</span>
        <span class="c"># Return a (2,3) numpy array</span>
        <span class="k">return</span> <span class="n">pv</span>
    <span class="k">def</span> <span class="nf">Position_and_Velocity_WRT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">body_ref</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="n">P0V0</span> <span class="o">=</span> <span class="n">body_ref</span><span class="o">.</span><span class="n">Position_and_Velocity</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="c"># Measured body's barycentric position and velocity</span>
        <span class="n">PV</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Position_and_Velocity</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="c"># Measured body's position and velocity with respect</span>
        <span class="c"># to reference body</span>
        <span class="n">pv</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">PV</span><span class="p">,</span> <span class="n">P0V0</span><span class="p">)</span>
        <span class="c"># Returns (2,3) numpy array</span>
        <span class="k">return</span> <span class="n">pv</span>
    <span class="k">def</span> <span class="nf">Update_Position_and_Velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="c"># Barycentric position and velocity of body at time (2,3)</span>
        <span class="n">pv</span>              <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Position_and_Velocity</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="c"># Append results to history keeping list for this body</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">times</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positions</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">pv</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">velocities</span><span class="p">,</span> <span class="n">pv</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]])</span>
        <span class="c"># Also returns barycentric position and velocty</span>
        <span class="k">return</span> <span class="bp">None</span>
</code></pre>
</div>

<p>Using what has just been constructed, values that may be of particular interest such as the relative position and velocity of Earth with respect to Mars at a certain Julian date, which can be used to approximate boundary conditions for interplanetary trajectory optimization, can be computed in an intuitive way.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">#Instantiate Earth as a massive celestial object</span>
<span class="n">Earth</span> <span class="o">=</span> <span class="n">Celestial_Body</span><span class="p">(</span><span class="s">'Earth'</span><span class="p">)</span>
<span class="c">#Instantiate Mars as a massive celestial object</span>
<span class="n">Mars</span>  <span class="o">=</span> <span class="n">Celestial_Body</span><span class="p">(</span><span class="s">'Mars'</span><span class="p">)</span>
<span class="c">#Times at which to compute position and velocity</span>
<span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2457061.5</span><span class="p">,</span> <span class="mf">2457062.5</span><span class="p">,</span> <span class="mf">2457063.5</span><span class="p">,</span> <span class="mf">2457064.5</span><span class="p">]</span>
<span class="c">#Compute the position and velocity w.r.t. Mars</span>
<span class="n">pv</span>  <span class="o">=</span> <span class="n">Earth</span><span class="o">.</span><span class="n">Position_and_Velocity_WRT</span><span class="p">(</span><span class="n">Mars</span><span class="p">,</span> <span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">pv</span>
<span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">3.16065185e+11</span><span class="p">,</span>   <span class="mf">4.67929557e+10</span><span class="p">,</span>   <span class="mf">2.47554111e+10</span><span class="p">],</span>
       <span class="p">[</span> <span class="o">-</span><span class="mf">1.59359727e+04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">4.39852824e+04</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.97710792e+04</span><span class="p">]])</span>
</code></pre>
</div>

<h2 id="review">Review</h2>
<p>So far the abstract idea of a physical body according to classical mechanics has been programmatically implemented and augmented with the more specific classification of a celestial body. It has been shown that the state of the interplanetary environment can be determined at specified times and observed over a discretized duration. The interplanetary environment serves as the medium in which the spacecraft will travel and therfore the basis of what is necessary to answer the question presented at the beginning of this tutorial: <strong>How will humans get to Mars?</strong>.</p>

<p>The code shown here can be seen as part of a larger project <a href="https://github.com/CISprague/Spacecraft_Testbed">here</a>. Stay tuned for the next part of this series in which the dynamics of the Mars bound spacecraft will be described.</p>

  </section>

  
</article>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2016 Matai Blacklock. All rights reserved.</span>
</footer>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>

    </div>
  </body>
</html>